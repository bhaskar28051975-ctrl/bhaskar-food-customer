<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhaskar Food - Order Now</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 pb-10">

    <header class="bg-white p-5 shadow-sm sticky top-0 z-50">
        <h1 class="text-2xl font-black text-red-600 italic text-center">Bhaskar <span class="text-gray-800 not-italic">Food</span></h1>
    </header>

    <main id="customer-list" class="max-w-md mx-auto p-4 space-y-6">
        </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAT074ME7aIbb4R2VzgZZGdw8F3alL-xbA",
            authDomain: "bhaskar-food-app.firebaseapp.com",
            databaseURL: "https://bhaskar-food-app-default-rtdb.firebaseio.com",
            projectId: "bhaskar-food-app",
            appId: "1:712053690568:web:b4d8b789e0359ebc0e95fd"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.sendWhatsApp = (resName, dish, price) => {
            const myNumber = "91XXXXXXXXXX"; // CHANGE THIS TO YOUR NUMBER
            const text = `*NEW FOOD ORDER*%0A%0A*Hotel:* ${resName}%0A*Dish:* ${dish}%0A*Price:* ₹${price}%0A%0A*Please confirm my order.*`;
            window.open(`https://wa.me/${myNumber}?text=${text}`, '_blank');
        };

        onValue(ref(db, 'restaurants'), (snap) => {
            const container = document.getElementById('customer-list');
            container.innerHTML = "";
            snap.forEach(child => {
                const res = child.val();
                let menuHtml = "";
                
                if(res.menu) {
                    Object.values(res.menu).forEach(item => {
                        menuHtml += `
                            <div class="flex justify-between items-center py-2 border-b border-dashed">
                                <div>
                                    <p class="font-bold text-gray-700">${item.dish}</p>
                                    <p class="text-sm text-green-600 font-bold">₹${item.price}</p>
                                </div>
                                <button onclick="sendWhatsApp('${res.name}', '${item.dish}', '${item.price}')" 
                                    class="bg-green-500 text-white px-3 py-1 rounded-lg text-xs font-black">ORDER</button>
                            </div>`;
                    });
                } else {
                    menuHtml = "<p class='text-xs text-gray-400'>Menu loading soon...</p>";
                }

                container.innerHTML += `
                    <div class="bg-white rounded-3xl shadow-md overflow-hidden border">
                        <img src="${res.image}" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h2 class="text-xl font-black uppercase text-gray-800">${res.name}</h2>
                            <p class="text-xs text-gray-400 mb-4">${res.cuisine}</p>
                            <div class="space-y-2">${menuHtml}</div>
                        </div>
                    </div>`;
            });
        });
    </script>
</body>
</html>
